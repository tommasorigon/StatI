---
title: 'Statistica I'
subtitle: 'Esercitazione 5: covarianza, correlazione, regressione lineare semplice'
lang: it
author: "[Tommaso Rigon]{.orange}"
institute: "_Università degli Studi di Milano-Bicocca_"
page-layout: full
format:
  html:
    html-math-method: katex
    echo: true
    callout-appearance: minimal
    theme: [simplex, ../template.css]
    toc: true
    toc-title: Indice
    embed-resources: false
    code-line-numbers: true
    smooth-scroll: true
    fig-dpi: 250
---


# [Homepage](../index.html)

Alcuni dei problemi di questa esercitazione [non]{.orange} sono stati svolti a lezione. Si consiglia agli studenti di provare a risolvere i problemi autonomamente. 


```{r startup, include = FALSE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = F, eval = T, message = F, warning = F, error = F, comment = NA, cache = F, include = T, R.options = list(width = 100), collapse = T, dpi = 200, fig.height = 4, fig.width = 6)
```


## Statura di padri e figli

La tabella che segue mostra le stature per un gruppo di padri e figli. 

| Statura padre| Statura figlio |
|-----:|------:|
|   165|    167|
|   170|    169|
|   180|    181|
|   172|    171|
|   179|    180|
|   174|    176|
|   176|    180|
|   168|    171|
|   181|    179|
|   173|    174|
|   170|    173|
|   178|    176|
|   176|    178|

----------------------------------

Presupponendo una relazione lineare tra le stature dei padri e le stature dei figli, si dica che statura ci si aspetta per il figlio di un padre alto 170.5 cm.

::: {.callout-note collapse=true}
### Schema della soluzione

In primo luogo disegniamo graficamente i dati tramite uno scatterplot

```{r}
library(ggplot2)
dataset <- data.frame(padre = c(165, 170, 180, 172, 179, 174, 176, 168, 181, 173, 170, 178, 176),
                      figlio = c(167, 169, 181, 171, 180, 176, 180, 171, 179, 174, 173, 176, 178))
ggplot(data=dataset, aes(x = padre, y = figlio)) + geom_point() + theme_bw() + xlab("Statura padre (cm)") + ylab("Statura figlio (cm)")
```


```{r}
#sum(padre)
#sum(padre*figlio)
#sum(figlio)

#sum(padre^2)
#sum(figlio^2)

#summary(lm(tabacchi ~alcolici))
```

Valutiamo quindi le principali quantità d'interesse, dove $x_1,\dots,x_{13}$ rappresentano le stature dei padri e $y_1,\dots,y_{13}$ rappresentano invece le stature dei figli. Di conseguenza, avremo che:

$$
\sum_{i=1}^nx_i y_i = 396096, \qquad \sum_{i=1}^nx_i = 2262, \qquad \sum_{i=1}^ny_i = 2275.
$$

È inoltre possibile calcolare le seguenti quantità

$$
\sum_{i=1}^nx_i^2 = 393876, \qquad \sum_{i=1}^ny_i^2 = 398375.
$$
Utilizzando le quantità del punto precedente, possiamo quindi ottenere la stima ai minimi quadrati $(\hat{\alpha},\hat{\beta})$ di un modello di regressione lineare semplice. In particolare, avremo che:

$$\hat{\beta} = \frac{\text{cov}(x,y)}{\text{var}(x)} = \frac{30468.92 - 174\times 175}{30298.15 - 174^2}= 0.854.$$
Si ha infatti che $\text{cov}(x,y) = 30468.92 - 174\times 175 = 18.92$ mentre $\text{var}(x) = 30298.15 - 174^2 = 22.15$. Inoltre avremo che:

$$
\hat{\alpha} = \bar{y} - \hat{\beta} \bar{x} = 175 - 0.854\times 174 = 26.404.
$$
I valori previsti si ottengono quindi tramite l'equazione:

$$
\hat{y}_i = 26.404 + 0.854 x_i.
$$
Pertanto, il valore previsto cercato è pari a $26.404 + 0.854 \times 170.5 = 172.011$.

:::