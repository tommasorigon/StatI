<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="it" xml:lang="it"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tommaso Rigon">

<title>Statistica I</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="17_11_2023_files/libs/clipboard/clipboard.min.js"></script>
<script src="17_11_2023_files/libs/quarto-html/quarto.js"></script>
<script src="17_11_2023_files/libs/quarto-html/popper.min.js"></script>
<script src="17_11_2023_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="17_11_2023_files/libs/quarto-html/anchor.min.js"></script>
<link href="17_11_2023_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="17_11_2023_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="17_11_2023_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="17_11_2023_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="17_11_2023_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<style>html{ scroll-behavior: smooth; }</style>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Indice</h2>
   
  <ul>
  <li><a href="#problema-1" id="toc-problema-1" class="nav-link active" data-scroll-target="#problema-1">Problema 1</a></li>
  <li><a href="#problema-2" id="toc-problema-2" class="nav-link" data-scroll-target="#problema-2">Problema 2</a></li>
  <li><a href="#problema-3" id="toc-problema-3" class="nav-link" data-scroll-target="#problema-3">Problema 3</a></li>
  </ul>
</nav>
</div>
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Statistica I</h1>
<p class="subtitle lead">Esame 17 Novembre 2023</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Autore/Autrice</div>
  <div class="quarto-title-meta-heading">Affiliazione</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Tommaso Rigon </p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            DEMS
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  

</header>

<section id="problema-1" class="level2">
<h2 class="anchored" data-anchor-id="problema-1">Problema 1</h2>
<p>I dati provengono da uno studio condotto da Charles Darwin nel 1875 riguardante i metodi di impollinazione. Un insieme di <span class="math inline">n = 15</span> <span class="blue">coppie</span> di piantine della stessa età, la prima ottenuta tramite impollinazione incrociata (<em>cross-fertilization</em>) e l’altra tramite auto-impollinazione (<em>self-fertilization</em>), sono state coltivate in condizioni quasi identiche.</p>
<p>I dati corrispondono alle <span class="orange">altezze</span> finali (in pollici) di ciascuna coppia di piante (<code>cross</code> e <code>self</code>), dopo un determinato periodo di tempo. La variabile <code>diff = cross - self</code> è pari alla differenza delle prime due variabili.</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">Coppia</th>
<th style="text-align: right;"><code>cross</code></th>
<th style="text-align: right;"><code>self</code></th>
<th style="text-align: right;"><code>diff</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">23.500</td>
<td style="text-align: right;">17.375</td>
<td style="text-align: right;">6.125</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">20.375</td>
<td style="text-align: right;">-8.375</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">21.000</td>
<td style="text-align: right;">20.000</td>
<td style="text-align: right;">1.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">22.000</td>
<td style="text-align: right;">20.000</td>
<td style="text-align: right;">2.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">19.125</td>
<td style="text-align: right;">18.375</td>
<td style="text-align: right;">0.750</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: right;">21.500</td>
<td style="text-align: right;">18.625</td>
<td style="text-align: right;">2.875</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: right;">22.125</td>
<td style="text-align: right;">18.625</td>
<td style="text-align: right;">3.500</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: right;">20.375</td>
<td style="text-align: right;">15.250</td>
<td style="text-align: right;">5.125</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: right;">18.250</td>
<td style="text-align: right;">16.500</td>
<td style="text-align: right;">1.750</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: right;">21.625</td>
<td style="text-align: right;">18.000</td>
<td style="text-align: right;">3.625</td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: right;">23.250</td>
<td style="text-align: right;">16.250</td>
<td style="text-align: right;">7.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">12</td>
<td style="text-align: right;">21.000</td>
<td style="text-align: right;">18.000</td>
<td style="text-align: right;">3.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">13</td>
<td style="text-align: right;">22.125</td>
<td style="text-align: right;">12.750</td>
<td style="text-align: right;">9.375</td>
</tr>
<tr class="even">
<td style="text-align: left;">14</td>
<td style="text-align: right;">23.000</td>
<td style="text-align: right;">15.500</td>
<td style="text-align: right;">7.500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">15</td>
<td style="text-align: right;">12.000</td>
<td style="text-align: right;">18.000</td>
<td style="text-align: right;">-6.000</td>
</tr>
</tbody>
</table>
<p>Si è interessati a verificare se l’impollinazione incrociata consente alle piante di avere maggior vigore, misurata in termini di altezza.</p>
<ol type="1">
<li><p>Si calcolino medie e varianze delle variabili <code>cross</code> e <code>self</code>. Si calcoli quindi la media della variabile <code>diff</code>.</p></li>
<li><p>Si confrontino tra loro le distribuzioni <code>cross</code> e <code>self</code> tramite due <em>boxplot</em>, evidenziando la presenza di eventuali valori anomali. Si riportino i valori di mediana e quartili delle due distribuzioni.</p></li>
<li><p>Si stabilisca se le medie delle distribuzioni <code>cross</code> e <code>self</code> sono diverse tra loro, facendo uso di opportuni indici che tengano conto della variabilità dei dati. Si <span class="blue">commentino i risultati</span> nel contesto del problema.</p></li>
<li><p>Si disegni la funzione di ripartizione <span class="math inline">F(\cdot)</span> della variabile <code>diff</code>. Si calcoli il valore di <span class="math inline">F(0)</span> e <span class="blue">si commenti il risultato</span> nel contesto del problema.</p></li>
</ol>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Schema della soluzione
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Statistiche descrittive delle variabili <code>cross</code>, <code>self</code> e <code>diff</code>.</p>
<div class="cell" data-layout-align="center">
<pre><code>##      Media cross  Media self Media diff Varianza cross Varianza self
## [1,]     20.19167     17.575   2.616667       12.21014       3.92875</code></pre>
</div>
<hr>
<p>Ulteriori statistiche descrittive per le variabili <code>cross</code> e <code>self</code>:</p>
<p>Primo quartile, mediana, terzo quartile della variabile <code>cross</code></p>
<div class="cell" data-layout-align="center">
<pre><code>##    25%    50%    75% 
## 19.125 21.500 22.125</code></pre>
</div>
<p>Primo quartile, mediana, terzo quartile della variabile <code>self</code></p>
<div class="cell" data-layout-align="center">
<pre><code>##    25%    50%    75% 
## 16.250 18.000 18.625</code></pre>
</div>
<p>Confronto tra i due boxplot, da cui è possibile notare la presenza di due outlier. Trattandosi di un confronto, i due boxplot andavano disegnati <span class="blue">nello stesso grafico</span>.</p>
<!-- Il grafico seguente utilizza una [definizione di quartili leggermente diversa]{.orange} da quella vista a lezione (si ottiene `16.325` al posto di `16.250`). Utilizzando la definizione di quartile vista a lezione, non risultano outlier per la variabile `self`. -->
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="17_11_2023_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="1600"></p>
</figure>
</div>
</div>
</div>
<hr>
<p>La dipendenza in media può essere misurata tramite l’indice <span class="math inline">\eta^2</span>, il cui calcolo richiede alcuni passaggi intermedi. Era possibile far uso di <span class="orange">appropriati</span> indici alternativi non menzionati nel corso. Tuttavia, indici quali il coefficiente di variazione non misurano la dipendenza in media, bensì esclusivamente la variabilità dei dati.</p>
<p>Devianza entro i gruppi:</p>
<div class="cell" data-layout-align="center">
<pre><code>## [1] 242.0833</code></pre>
</div>
<p>Devianza tra i gruppi:</p>
<div class="cell" data-layout-align="center">
<pre><code>## [1] 51.35208</code></pre>
</div>
<p>Devianza totale:</p>
<div class="cell" data-layout-align="center">
<pre><code>## [1] 293.4354</code></pre>
</div>
<p>Indice <span class="math inline">\eta^2</span> è quindi pari a:</p>
<div class="cell" data-layout-align="center">
<pre><code>## [1] 0.175003</code></pre>
</div>
<p>Se ne deduce una lieve dipendenza in media, che a sua volta implica che il metodo di impollinazione incrociata consente alle piante di avere maggior vigore. Questo risultato sembra essere in parziale contraddizione con quanto mostrato dai boxplot, che evidenziano una dipendenza in distribuzione tra i due gruppi molto più marcata. È tuttavia possibile che <span class="math inline">\eta^2</span> sia relativamente basso a causa dei due outlier (entrambi pari a <code>12</code>) presenti nella variabile <code>cross</code>.</p>
<hr>
<p>Funzione di ripartizione empirica della variabile <code>diff</code>:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="17_11_2023_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="1600"></p>
</figure>
</div>
</div>
</div>
<p>La linea verticale tratteggiata indica il valore della funzione di ripartizione valutata in <span class="math inline">0</span>, ovvero <span class="math inline">F(0)</span>:</p>
<div class="cell" data-layout-align="center">
<pre><code>## [1] 0.1333333</code></pre>
</div>
<p>Di consequenza, la maggioranza delle piantine <code>cross</code>, ovvero circa l’<span class="math inline">87\%</span>, assume valori maggiori di quelle <code>self</code>, dimostrando nuovamente una forte dipendenza. In altri termini, l’impollinazione incrociata sembra essere associata a piantine di maggior vigore.</p>
</div>
</div>
</div>
</section>
<section id="problema-2" class="level2">
<h2 class="anchored" data-anchor-id="problema-2">Problema 2</h2>
<p>Si vuole analizzare la potenzialità di un fertilizzante nel velocizzare la crescita degli alberi. Per <span class="math inline">n = 10</span> alberi si rileva la quantità di <code>fertilizzante</code> che è stata usata nel terreno su cui ciascun alberto è stato coltivato, espressa in mg per g, e la velocità di <code>crescita</code> dell’albero, in cm al mese. Le osservazioni sono riportate nella tabella seguente.</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;"><code>fertilizzante</code></th>
<th style="text-align: right;"><code>crescita</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">8.31</td>
<td style="text-align: right;">7.51</td>
</tr>
<tr class="even">
<td style="text-align: right;">9.15</td>
<td style="text-align: right;">9.04</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7.77</td>
<td style="text-align: right;">6.64</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.39</td>
<td style="text-align: right;">4.65</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">1.85</td>
</tr>
<tr class="even">
<td style="text-align: right;">8.94</td>
<td style="text-align: right;">8.37</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.13</td>
<td style="text-align: right;">5.10</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.39</td>
<td style="text-align: right;">2.61</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4.30</td>
<td style="text-align: right;">6.01</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.03</td>
<td style="text-align: right;">4.30</td>
</tr>
</tbody>
</table>
<ol type="1">
<li><p>Si rappresentino graficamente le variabili <code>fertilizzante</code> e <code>crescita</code> tramite un diagramma a dispersione.</p></li>
<li><p>Si specifichi un modello di regressione per studiare la <code>crescita</code> media in funzione della quantità di <code>fertilizzante</code>. Si stimi tale modello.</p></li>
<li><p>Si ottenga un indice di bontà d’adattamento per il modello stimato al punto precedente. Si ottenga inoltre la varianza residuale di tale modello.</p></li>
<li><p>La crescita media aumenta con la quantità di fertilizzante? Si <strong>argomenti</strong>, basandosi sui risultati ottenuti ai punti precedenti.</p></li>
<li><p>Si dica qual è la crescita media in assenza di fertilizzante. Inoltre, quanto fertilizzante è necessario affinchè la crescita media sia pari a <span class="math inline">5</span>cm al mese?</p></li>
</ol>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Schema della soluzione
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Grafico a dispersione (richiesto), con retta di regressione stimata (non richiesta)</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="17_11_2023_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="1600"></p>
</figure>
</div>
</div>
</div>
<hr>
<p>Alcune utili statistiche descrittive preliminari:</p>
<div class="cell" data-layout-align="center">
<pre><code>##      Media fert. Media crescita Varianza fert. Varianza crescita Covarianza Correlazione
## [1,]       5.172          5.608       9.580736          5.024876   6.684884    0.9634557</code></pre>
</div>
<p>Coefficienti del modello di regressione stimati <span class="math inline">(\hat{\alpha},\hat{\beta})</span>:</p>
<div class="cell" data-layout-align="center">
<pre><code>## (Intercept)           x 
##   1.9992772   0.6977422</code></pre>
</div>
<hr>
<p>Indice <span class="math inline">R^2</span> e varianza residuale:</p>
<div class="cell" data-layout-align="center">
<pre><code>## [1] 0.9282469 0.3605502</code></pre>
</div>
<hr>
<p>La quantità fertilizzante sembra pertanto comportare un <span class="orange">aumento</span> della crescita. Ciò si deduce dal fatto che il coefficiente <span class="math inline">\hat{\beta}</span> calcolato in precedenza è positivo, congiuntamente al fatto che il coefficiente di correlazione <span class="math inline">\rho</span> è grande e positivo.</p>
<p>Si noti il valore di <span class="math inline">R^2</span>, da solo, <span class="orange">non</span> consente di stabilire se esiste una relazione positiva o negativa tra le due variabili.</p>
<hr>
<p>Previsione della crescita quando <span class="math inline">x = 0</span> coincide con <span class="math inline">\hat{\alpha}</span>, ovvero:</p>
<div class="cell" data-layout-align="center">
<pre><code>## (Intercept) 
##    1.999277</code></pre>
</div>
<p>Valore del fertilizzante tale per cui la crescita è pari a <span class="math inline">5</span>:</p>
<div class="cell" data-layout-align="center">
<pre><code>## (Intercept) 
##    4.300618</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="problema-3" class="level2">
<h2 class="anchored" data-anchor-id="problema-3">Problema 3</h2>
<p>Si risponda a <strong>tutti</strong> i seguenti quesiti di carattere <strong>teorico</strong>.</p>
<ol type="1">
<li><p>Dopo averne dato la definizione, si <strong>dimostri</strong> che la media geometrica <span class="math inline">\mathbb{G}</span> di un insieme di dati <span class="math inline">x_1,\dots,x_n</span> a valori strettamente positivi è minore o uguale della loro media aritmetica <span class="math inline">\bar{x}</span>. Si menzionino esplicitamente i risultati teorici utilizzati nella dimostrazione.</p></li>
<li><p>Si enunci e si <strong>dimostri</strong> il teorema di scomposizione della devianza.</p></li>
<li><p>Nel contesto delle tabelle di contingenza, si <strong>dimostri</strong> che le seguenti formule del <span class="math inline">\chi^2</span> sono equivalenti:</p></li>
</ol>
<p><span class="math display">
\chi^2 = \sum_{i=1}^h\sum_{j=1}^k \frac{(n_{ij} - \hat{n}_{ij})^2}{\hat{n}_{ij}} = n\left[\sum_{i=1}^h\sum_{j=1}^k\left(\frac{f_{ij}^2}{f_{i+}f_{+j}}\right) - 1\right].
</span></p>
<hr>
<p>La soluzione di questi esercizi è presente nelle slides oppure è stata spiegata in classe.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiato!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiato!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



<script src="17_11_2023_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>