knitr::kable(list(tab[rows,1:2], tab[-rows, 1:2]), row.names = FALSE)
diametri <- 18:77
frequenze <- c(21,47,34,69,74,52,46,28,49,40,
43,48,51,65,76,64,72,33,32,59,
45,41,43,49,45,42,39,40,47,35,
38,26,31,46,48,23,39,30,29,16,
17,23,12,14,10,11,4,3,0,4,
7,1,5,0,6,9,0,4,0,2)
set.seed(123) # Se stai leggendo questo codice: si, ho barato. Non sono dati nuovi, ho solo ricampionato quelli originali
id <- sample(1887,30)
diam_full <- sort(rep(diametri, frequenze)[id])
n <- length(diam_full)
tab <- data.frame(unique(diam_full), as.numeric(table(diam_full)))
# tab <- cbind(tab[1:11,],tab[12:22,])
colnames(tab) <- c("D","$n_j$")
rows <- seq_len(nrow(tab) %/% 2)
knitr::kable(list(tab[rows,1:2], tab[-rows, 1:2]), row.names = FALSE)
# Chunk 1: startup
knitr::opts_chunk$set(echo = F, eval= T, message=F, warning=F, error=F, comment=NA, cache=F, include=T, R.options=list(width=220), dpi = 200, fig.align = "center")
diametri <- 18:77
frequenze <- c(21,47,34,69,74,52,46,28,49,40,
43,48,51,65,76,64,72,33,32,59,
45,41,43,49,45,42,39,40,47,35,
38,26,31,46,48,23,39,30,29,16,
17,23,12,14,10,11,4,3,0,4,
7,1,5,0,6,9,0,4,0,2)
set.seed(123) # Se stai leggendo questo codice: si, ho barato. Non sono dati nuovi, ho solo ricampionato quelli originali
id <- sample(1887,30)
diam_full <- sort(rep(diametri, frequenze)[id])
n <- length(diam_full)
tab <- data.frame(unique(diam_full), as.numeric(table(diam_full)))
# tab <- cbind(tab[1:11,],tab[12:22,])
colnames(tab) <- c("D","$n_j$")
rows <- seq_len(nrow(tab) %/% 2)
knitr::kable(list(tab[rows,1:2], tab[-rows, 1:2]), row.names = FALSE)
knitr::kable(list(t(tab[rows,1:2]), t(tab[-rows, 1:2])), row.names = FALSE)
knitr::kable(list(t(tab[rows,1:2]), t(tab[-rows, 1:2])), row.names = TRUE)
knitr::kable(list(t(tab[rows,1:2]), t(tab[-rows, 1:2])), row.names = TRUE, colnames = FALSE)
knitr::kable(list(t(tab[rows,1:2]), t(tab[-rows, 1:2])), row.names = TRUE, col.names = FALSE)
knitr::kable(t(tab[rows,1:2]), row.names = TRUE, col.names = FALSE)
knitr::kable(t(tab[rows,1:2]), col.names = FALSE)
knitr::kable(t(tab[rows,1:2]))
knitr::kable(t(tab[rows,1:2]), col.names = NULL)
knitr::kable(t(tab[-rows,1:2]), col.names = NULL)
unlink("esami/22_11_2021_cache", recursive = TRUE)
knit_with_parameters("~/Library/Mobile Documents/com~apple~CloudDocs/University/Didattica/STAT I/StatI/esami/22_11_2021.qmd")
knitr::opts_chunk$set(echo = FALSE, fig.align = "center")
dati = c()
numerosità = c(0, 15, 27, 18, 10, 1)
for(i in 1:6)
{
dati = c(dati, runif(numerosità[i], min = 248+i, max = 249+i))
}
hist(dati,
breaks = 249:255,
freq = T,
ylim = c(0, 30),
main = "Istogramma",
xlab = "Peso (g)",
ylab = "Frequenze assolute"
)
# Chunk 1: startup
knitr::opts_chunk$set(echo = F, eval = T, message = F, warning = F, error = F, comment = NA, cache = F, include = T, R.options = list(width = 100), collapse = T, dpi = 200, fig.align = "center", fig.height = 4, fig.width = 8)
# Chunk 2
library(ggplot2)
nomi <- c("Buono","Medio","Scarso","Assente")
Lombare <- data.frame(Frammentazione = ordered(rep(nomi, c(12, 26, 3, 1) ), levels= nomi))
ggplot(data=Lombare, aes(x=Frammentazione, y=..count..)) + geom_bar() + theme_bw() + xlab("Efficacia del trattamento") + ylab("Frequenze assolute")
# Chunk 3
Lombare <- c(12, 26, 3, 1)
Pre <- c(2, 8, 0, 0)
Pelvico <- c(12, 13, 2, 1)
k <- length(Lombare)
nn <- Pre
f <- nn/sum(nn)
G <- 1 - sum(f^2)
#round(k / (k-1)*G,2)
H <- - sum(f*log(f),na.rm = TRUE)
#round(H / log(k),2)
nomi <- c( "Enel prod.", "Erga","Valgen","Eurogen", "Elettrogen", "Interpower", "Edison", "Sondel", "Altri")
TWh <- c(125.204,7.513,0.127,22.471,7.576,19.636,17.254,6.265,29.880)
freq_rel <- TWh / sum(TWh)
#library(knitr)
#kable(data.frame(nomi, freq_rel, freq_rel^2, log(freq_rel), freq_rel*log(freq_rel)), digits=4)
data.frame(nomi,freq_rel)[order(freq_rel), ]
dat2 <- data.frame(nomi,freq_rel)[order(freq_rel), ]
dat2 <- data.frame(nomi,freq_rel)[order(freq_rel), ]
dat2$p <- 1:nrow(dat2) / nrow(dat2)
dat2$q <- cumsum(dat2$freq_rel)
dat2
kable(dat2)
library(knitr)
kable(dat2)
kable(dat2, digits = 3)
kable(dat2, digits = 4)
# Chunk 1: startup
knitr::opts_chunk$set(echo = F, eval = T, message = F, warning = F, error = F, comment = NA, cache = F, include = T, R.options = list(width = 100), collapse = T, dpi = 200, fig.align = "center", fig.height = 4, fig.width = 8)
# Chunk 2
library(ggplot2)
nomi <- c("Buono","Medio","Scarso","Assente")
Lombare <- data.frame(Frammentazione = ordered(rep(nomi, c(12, 26, 3, 1) ), levels= nomi))
ggplot(data=Lombare, aes(x=Frammentazione, y=..count..)) + geom_bar() + theme_bw() + xlab("Efficacia del trattamento") + ylab("Frequenze assolute")
# Chunk 3
Lombare <- c(12, 26, 3, 1)
Pre <- c(2, 8, 0, 0)
Pelvico <- c(12, 13, 2, 1)
k <- length(Lombare)
nn <- Pre
f <- nn/sum(nn)
G <- 1 - sum(f^2)
#round(k / (k-1)*G,2)
H <- - sum(f*log(f),na.rm = TRUE)
#round(H / log(k),2)
nomi <- c( "Enel prod.", "Erga","Valgen","Eurogen", "Elettrogen", "Interpower", "Edison", "Sondel", "Altri")
TWh <- c(125.204,7.513,0.127,22.471,7.576,19.636,17.254,6.265,29.880)
freq_rel <- TWh / sum(TWh)
#library(knitr)
#kable(data.frame(nomi, freq_rel, freq_rel^2, log(freq_rel), freq_rel*log(freq_rel)), digits=4)
dat2 <- data.frame(nomi,freq_rel)[order(freq_rel), ]
dat2$p <- 1:nrow(dat2) / nrow(dat2)
dat2$q <- cumsum(dat2$freq_rel)
#kable(dat2, digits = 4)
plot(dat2$p, dat2$q)
plot(dat2$p, dat2$q, type = "l")
plot(dat2$p, dat2$q, type = "l", xlim = c(0, 1), ylim = c(0, 1))
plot(c(0, dat2$p), c(0,dat2$q), type = "l", xlim = c(0, 1), ylim = c(0, 1))
plot(c(0, dat2$p), c(0,dat2$q), type = "b", xlim = c(0, 1), ylim = c(0, 1), pch = 1)
plot(c(0, dat2$p), c(0,dat2$q), type = "b", xlim = c(0, 1), ylim = c(0, 1), pch = 16)
abline(c(0, 1), lty = "dotted")
plot(c(0, dat2$p), c(0,dat2$q), type = "b", xlim = c(0, 1), ylim = c(0, 1), pch = 16, xlab = "p", ylab = "q")
plot(c(0, dat2$p), c(0,dat2$q), type = "b", xlim = c(0, 1), ylim = c(0, 1), pch = 16, xlab = "Frazione cumulata dei casi",
ylab = "Frazione cumulata della quota di mercato")
plot(c(0, dat2$p), c(0,dat2$q), type = "b", xlim = c(0, 1), ylim = c(0, 1), pch = 16, xlab = "Frazione cumulata dei casi",
ylab = "Frazione cumulata della quota di mercato", main = "Curva di Lorenz")
abline(c(0, 1), lty = "dotted")
plot(c(0, dat2$p, 1), c(0,dat2$q, 1), type = "b", xlim = c(0, 1), ylim = c(0, 1), pch = 16, xlab = "Frazione cumulata dei casi",
ylab = "Frazione cumulata della quota di mercato", main = "Curva di Lorenz")
abline(c(0, 1), lty = "dotted")
dat2$p
dat2$q
nrow(dat2)
dat2$q
round(dat2$q, 4)
dat2$q
sum(dat2$q[-8])
R <- 1 - 2 / (nrow(dat2) - 1) * sum(dat2$q[-8])
R
round(R, 4)
sum( (dat2$q[-8] - dat2$q[-8]) / dat2$p[-8])
sum( (dat2$q[-8] - dat2$p[-8]) / dat2$p[-8])
sum( (dat2$p[-8] - dat2$q[-8]) / dat2$p[-8])
sum( (dat2$p[-8] - dat2$q[-8])) / sum(dat2$p[-8])
dat2$p
dat2$q[-9]
sum( (dat2$p[-9] - dat2$q[-9])) / sum(dat2$p[-9])
R <- 1 - 2 / (nrow(dat2) - 1) * sum(dat2$q[-9])
R
round(R, 4)
sum( (dat2$p[-9] - dat2$q[-9])) / sum(dat2$p[-9])
dat2$q[-9]
#sum( (dat2$p[-9] - dat2$q[-9])) / sum(dat2$p[-9])
R <- 1 - 2 / (nrow(dat2) - 1) * sum(dat2$q[-9])
# round(R, 4)
#kable(dat2, digits = 4)
```
province_lombardia <- c(877688, 595513, 178472, 3219391, 1103768, 1253993, 534968, 351169, 404696, 332043)
names(province_lombardia) <- c("Varese", "Como", "Sondrio", "Milano", "Bergamo", "Brescia", "Pavia", "Cremona", "Mantova", "Lecco")
province_lombardia
names(province_lombardia) <- c("Varese", "Como", "Sondrio", "Milano", "Bergamo", "Brescia", "Pavia", "Cremona", "Mantova", "Lecco", "Lodi", "Monza e della Brianza")
province_lombardia
names(province_lombardia) <- c("Varese", "Como", "Sondrio", "Milano", "Bergamo", "Brescia", "Pavia", "Cremona", "Mantova", "Lecco", "Lodi", "Monza e Brianza")
province_lombardia
lombard <- sort(lombard)
lombard <- c(877688, 595513, 178472, 3219391, 1103768, 1253993, 534968, 351169, 404696, 332043, 227495, 871546)
names(lombard) <- c("Varese", "Como", "Sondrio", "Milano", "Bergamo", "Brescia", "Pavia", "Cremona", "Mantova", "Lecco", "Lodi", "Monza e Brianza")
lombard
lombard <- sort(lombard)
lombard
p_lomb <- 1:length(lombard) / length(lombard)
p_lomb
lombard <- sort(lombard)
p_lomb <- 1:length(lombard) / length(lombard)
q_lomb <- cumsum(lombard)
q_lomb
q_lomb <- cumsum(lombard) / sum(lombard)
q_lomb
kable(data.frame(p = p_lomb, q = q_lomb))
plot(c(0, p_lomb), c(0,q_lomb), type = "b", xlim = c(0, 1), ylim = c(0, 1), pch = 16, xlab = "Frazione cumulata dei casi",
ylab = "Frazione cumulata della quota di mercato", main = "Curva di Lorenz")
abline(c(0, 1), lty = "dotted")
par(mfrow = c(1, 2))
plot(c(0, p_lomb), c(0,q_lomb), type = "b", xlim = c(0, 1), ylim = c(0, 1), pch = 16, xlab = "Frazione cumulata dei casi",
ylab = "Frazione cumulata della quota di mercato", main = "Curva di Lorenz")
abline(c(0, 1), lty = "dotted")
plot(c(0, p_lomb), c(0,q_lomb), type = "b", xlim = c(0, 1), ylim = c(0, 1), pch = 16, xlab = "Frazione cumulata dei casi",
ylab = "Frazione cumulata della quota di mercato", main = "Veneto")
abline(c(0, 1), lty = "dotted")
R_lomb <- 1 - 2 / (length(lombard) - 1) * sum(dat2$q[-length(lombard)])
R_lomb
lombard
lombard <- c(877688, 595513, 178472, 3219391, 1103768, 1253993, 534968, 351169, 404696, 332043, 227495, 871546)
names(lombard) <- c("Varese", "Como", "Sondrio", "Milano", "Bergamo", "Brescia", "Pavia", "Cremona", "Mantova", "Lecco", "Lodi", "Monza e Brianza")
lombard
names(veneto) <- c("Verona", "Vicenza", "Belluno", "Treviso", "Venezia", "Padova", "Rovigo")
veneto
veneto <- c(923950, 850942, 197751, 876115, 833703, 928374, 227418)
names(veneto) <- c("Verona", "Vicenza", "Belluno", "Treviso", "Venezia", "Padova", "Rovigo")
veneto
veneto <- sort(veneto)
veneto <- c(923950, 850942, 197751, 876115, 833703, 928374, 227418)
names(veneto) <- c("Verona", "Vicenza", "Belluno", "Treviso", "Venezia", "Padova", "Rovigo")
veneto <- sort(veneto)
p_ven <- 1:length(veneto) / length(veneto)
q_ven <- cumsum(veneto) / sum(veneto)
kable(data.frame(p = p_veneto, q = q_veneto))
kable(data.frame(p = p_ven, q = q_ven))
kable(data.frame(p = p_lomb, q = q_lomb))
kable(data.frame(p = p_ven, q = q_ven))
R_lomb <- 1 - 2 / (length(lombard) - 1) * sum(q_lomb[-length(lombard)])
R_lomb
kable(data.frame(p = p_ven, q = q_ven))
R_ven <- 1 - 2 / (length(veneto) - 1) * sum(q_ven[-length(lombard)])
R_ven
R_ven <- 1 - 2 / (length(veneto) - 1) * sum(q_ven[-length(ven)])
R_ven
R_ven <- 1 - 2 / (length(veneto) - 1) * sum(q_ven[-length(veneto)])
R_ven
kable(data.frame(p = p_ven, q = q_ven))
R_ven <- 1 - 2 / (length(veneto) - 1) * sum(q_ven[-length(veneto)])
R_ven
plot(c(0, p_ven), c(0,q_ven), type = "b", xlim = c(0, 1), ylim = c(0, 1), pch = 16, xlab = "Frazione cumulata dei casi",
ylab = "Frazione cumulata della quota di mercato", main = "Veneto")
abline(c(0, 1), lty = "dotted")
par(mfrow = c(1, 2))
plot(c(0, p_lomb), c(0,q_lomb), type = "b", xlim = c(0, 1), ylim = c(0, 1), pch = 16, xlab = "Frazione cumulata dei casi",
ylab = "Frazione cumulata della quota di mercato", main = "Lombardia")
abline(c(0, 1), lty = "dotted")
plot(c(0, p_ven), c(0,q_ven), type = "b", xlim = c(0, 1), ylim = c(0, 1), pch = 16, xlab = "Frazione cumulata dei casi",
ylab = "Frazione cumulata della quota di mercato", main = "Veneto")
abline(c(0, 1), lty = "dotted")
points(c(0, p_ven), c(0,q_ven), col = "red")
par(mfrow = c(1, 2))
plot(c(0, p_lomb), c(0,q_lomb), type = "b", xlim = c(0, 1), ylim = c(0, 1), pch = 16, xlab = "Frazione cumulata dei casi",
ylab = "Frazione cumulata della quota di mercato", main = "Lombardia")
abline(c(0, 1), lty = "dotted")
par(mfrow = c(1, 1))
plot(c(0, p_lomb), c(0,q_lomb), type = "b", xlim = c(0, 1), ylim = c(0, 1), pch = 16, xlab = "Frazione cumulata dei casi",
ylab = "Frazione cumulata della quota di mercato", main = "Lombardia")
abline(c(0, 1), lty = "dotted")
points(c(0, p_ven), c(0,q_ven), col = "red")
plot(c(0, p_lomb), c(0,q_lomb), type = "b", xlim = c(0, 1), ylim = c(0, 1), pch = 16, xlab = "Frazione cumulata dei casi",
ylab = "Frazione cumulata della quota di mercato", main = "Lombardia", col = "darkblue")
abline(c(0, 1), lty = "dotted")
points(c(0, p_ven), c(0,q_ven), col = "darkorange", pch = 16)
lines(c(0, p_ven), c(0,q_ven), col = "darkorange")
plot(c(0, p_lomb), c(0,q_lomb), type = "b", xlim = c(0, 1), ylim = c(0, 1), pch = 16, xlab = "Frazione cumulata dei casi",
ylab = "Frazione cumulata della quota di mercato", main = "Lombardia (Blu) - Vento (Arancione)", col = "darkblue")
abline(c(0, 1), lty = "dotted")
points(c(0, p_ven), c(0,q_ven), col = "darkorange", pch = 16)
lines(c(0, p_ven), c(0,q_ven), col = "darkorange")
lombard <- c(877688, 595513, 178472, 3219391, 1103768, 1253993, 534968, 351169, 404696, 332043, 227495, 871546)
names(lombard) <- c("Varese", "Como", "Sondrio", "Milano", "Bergamo", "Brescia", "Pavia", "Cremona", "Mantova", "Lecco", "Lodi", "Monza e Brianza")
library(knitr)
kable(lombard)
kable(veneto)
kable(data.frame(p = p_lomb, q = q_lomb))
lombard <- sort(lombard)
p_lomb <- 1:length(lombard) / length(lombard)
q_lomb <- cumsum(lombard) / sum(lombard)
kable(data.frame(p = p_lomb, q = q_lomb))
kable(data.frame(p = p_lomb, q = q_lomb), digits = 4)
veneto <- sort(veneto)
p_ven <- 1:length(veneto) / length(veneto)
q_ven <- cumsum(veneto) / sum(veneto)
kable(data.frame(p = p_ven, q = q_ven), digits = 4)
kable(data.frame(abit = veneto, p = p_ven, q = q_ven), digits = 4)
#
kable(data.frame(abit = lombard, p = p_lomb, q = q_lomb), digits = 4)
length(lombard)
R_lomb <- 1 - 2 / (length(lombard) - 1) * sum(q_lomb[-length(lombard)])
R_lomb
round(R_lomb, 4)
mean(lombard)
n_lomb <- length(lombard)
R_lomb <- 1 - 2 / (n_lomb - 1) * sum(q_lomb[-n_lomb])
R_lomb
Delta_lomb <- 4 / (n_lomb * (n_lomb -1)) * sum(lombard * 1:n_lomb) - 2 * mean(lombard) * (n_lomb + 1) / (n_lomb - 1)
Delta_lomb
n_lomb
sum(lombard * 1:n_lomb)
Delta_lomb <- 4 / (n_lomb * (n_lomb -1)) * sum(lombard * 1:n_lomb) - 2 * mean(lombard) * (n_lomb + 1) / (n_lomb - 1)
Delta_lomb
790672.1 / (2 * 829228.5)
R_ven <- 1 - 2 / (length(veneto) - 1) * sum(q_ven[-length(veneto)])
R_ven
round(R_ven, 4)
sum(lombard)
sum(veneto)
178472 / 9950742
2/12
(178472 + 227495) / 9950742
